<VirtualHost *:80>

    LoadModule macro_module /usr/lib/apache2/modules/mod_macro.so
    # Don't load all default modules, only load those needed.
    #Include conf.modules.d/*.conf
    LoadModule access_compat_module /usr/lib/apache2/modules/mod_access_compat.so
    LoadModule alias_module /usr/lib/apache2/modules/mod_alias.so
    LoadModule auth_basic_module /usr/lib/apache2/modules/mod_auth_basic.so
    LoadModule authn_core_module /usr/lib/apache2/modules/mod_authn_core.so
    LoadModule authn_file_module /usr/lib/apache2/modules/mod_authn_file.so
    LoadModule authz_core_module /usr/lib/apache2/modules/mod_authz_core.so
    LoadModule authz_groupfile_module /usr/lib/apache2/modules/mod_authz_groupfile.so
    LoadModule authz_host_module /usr/lib/apache2/modules/mod_authz_host.so
    LoadModule authz_user_module /usr/lib/apache2/modules/mod_authz_user.so
    LoadModule autoindex_module /usr/lib/apache2/modules/mod_autoindex.so
    LoadModule dir_module /usr/lib/apache2/modules/mod_dir.so
    LoadModule env_module /usr/lib/apache2/modules/mod_env.so
    LoadModule filter_module /usr/lib/apache2/modules/mod_filter.so
    LoadModule headers_module /usr/lib/apache2/modules/mod_headers.so
    # LoadModule log_config_module /usr/lib/apache2/modules/mod_log_config.so
    LoadModule mime_module /usr/lib/apache2/modules/mod_mime.so
    LoadModule reqtimeout_module /usr/lib/apache2/modules/mod_reqtimeout.so
    LoadModule rewrite_module /usr/lib/apache2/modules/mod_rewrite.so
    LoadModule setenvif_module /usr/lib/apache2/modules/mod_setenvif.so
    LoadModule status_module /usr/lib/apache2/modules/mod_status.so
    # LoadModule unixd_module /usr/lib/apache2/modules/mod_unixd.so
    # LoadModule version_module /usr/lib/apache2/modules/mod_version.so
    LoadModule vhost_alias_module /usr/lib/apache2/modules/mod_vhost_alias.so
    LoadModule mpm_prefork_module /usr/lib/apache2/modules/mod_mpm_prefork.so
    LoadModule proxy_module /usr/lib/apache2/modules/mod_proxy.so
    LoadModule proxy_fcgi_module /usr/lib/apache2/modules/mod_proxy_fcgi.so
    LoadModule proxy_http_module /usr/lib/apache2/modules/mod_proxy_http.so

    DocumentRoot /var/www/html 
    ServerName e.clinique.na.ca.ncsapreprod.abcd.feature.elco.cloud
    #ServerAlias m.e.clinique.na.us.xyz-123-elb3.ncsapreprod.abcd.feature.elco.cloud

    #PG handles
    RewriteEngine On
    ProxyPreserveHost On

    # <Directory "/var/www/html">
    #     Options Indexes FollowSymLinks
    #     AllowOverride All
    #     # AuthType Basic
    #     # AuthName "Frontend Testing Login"
    #     # AuthUserFile /var/www/usersfile
    # </Directory>

    RewriteRule ^/enrpc/(.*) http://172.29.4.191:8888/bridge/$1?%{QUERY_STRING} [P,L]
    RewriteRule ^/enref/(.*) http://172.29.4.191:8888/$1?%{QUERY_STRING} [P,L]
    RewriteRule ^/tools.php /tools/index.php [NC,L,R=301]

    RewriteRule "/(.*)\.(tmpl|json|logic)$" "http://172.29.1.249:80/$1.$2?%{QUERY_STRING}" [P]

    RewriteRule ^/css/pc/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/js/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/lcl/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/magicjs/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/o_/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/rpc/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/shared/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/rest/api/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/docs/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/images/macpro/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/images/search_icons/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/images/tips/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/macpro http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/macpro/(.*) http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]
    RewriteRule ^/media/images/macpro/(.*)  http://172.29.1.249:80/$1.$2?%{QUERY_STRING} [P]

    <LocationMatch "^/images">
      RequestHeader set host "s3.amazonaws.com"
      RequestHeader unset Authorization
      RewriteRule ^/var/www/html/images/(.*) http://s3.amazonaws.com/elc-alfresco-prod/Sites/clinique/documentLibrary/na/media/export/images/$1 [P]
    </LocationMatch>

    <LocationMatch "^/media/drupal_ui">
      RequestHeader set host "s3.amazonaws.com"
      RequestHeader unset Authorization
      RewriteRule ^/var/www/html/media/drupal_ui/(.*) http://s3.amazonaws.com/elc-alfresco-prod/Sites/clinique/media/drupal_ui/$1 [P]
    </LocationMatch>

    <LocationMatch "^/media">
      RequestHeader set host "s3.amazonaws.com"
      RequestHeader unset Authorization
      RewriteRule ^/var/www/html/media/(.*) http://s3.amazonaws.com/elc-alfresco-prod/Sites/clinique/documentLibrary/na/media/$1 [P]
    </LocationMatch>

    ProxyPass /s3fs-css/ http://s3.amazonaws.com/elc-drupal-shared-files/s3fs-public/
    ProxyPassReverse /s3fs-css/ http://s3.amazonaws.com/elc-drupal-shared-files/s3fs-public/
    <LocationMatch "^/s3fs-css">
      RequestHeader set host "s3.amazonaws.com"
      RequestHeader unset Authorization
    </LocationMatch>

    ProxyPass /s3fs-js/ http://s3.amazonaws.com/elc-drupal-shared-files/s3fs-public/
    ProxyPassReverse /s3fs-js/ http://s3.amazonaws.com/elc-drupal-shared-files/s3fs-public/
    <LocationMatch "^/s3fs-js">
      RequestHeader set host "s3.amazonaws.com"
      RequestHeader unset Authorization
    </LocationMatch>

  </VirtualHost>
